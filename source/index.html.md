---
title: Automate API
# language_tabs:
#   - shell: Bash
#   - python: Python
#   - javascript: JavaScript
toc_footers: []
includes: []
search: true
highlight_theme: darkula
headingLevel: 2
---

# Introduction

Welcome to the Primer Automate API! You can use our API to access various Automate endpoints.

> The base URL for your API calls is:

```
https://auto.primer.ai/api/v1alpha/automate/
```

## Getting Started

Requests to Automate are standard HTTP(s) calls that can be made from the command line or using the tools available in your chosen programming language, framework, or BI tool. There’s no need to install any additional bespoke packages.

> Sample request:

```shell
curl -X 'POST' 'https://auto.primer.ai/api/v1alpha/automate/models/e9176b92-ad5f-46b8-8a6a-1363709db18e/predictions' \
  -H 'Content-Type: application/json' \
  -d '{"text": "The content to analyze goes here"}' \
  -H 'Authorization: JWT $YOUR_TOKEN'
```

> Sample response (JSON):

```json
{
  "labels": [
    {
      "label": "NT",
      "score": 0.946445643901825,
      "threshold": 0.5,
      "classification": true
    },
    {
      "label": "OT",
      "score": 0.13132330775260925,
      "threshold": 0.5,
      "classification": false
    }
  ],
  "model_type": "CLF_MULTILABEL"
}
```

## Authentication

Automate requests must include a JSON Web Token (JWT) that can be generated by making a POST request to the following URL with your username and password:

`https://sso.primer.ai/api/v1/auth/login`

> Using Python:

```python
res = requests.post(
    "https://sso.primer.ai/api/v1/auth/login",
    headers={"Content-Type": "application/json"},
    data=json.dumps(
        {
            "username": '$YOUR_USERNAME',
            "password": '$YOUR_PASSWORD',
        }
    ),
)

JWT_TOKEN = res.json()['access_token']
```

> Using cURL:

```shell
curl -X POST "https://sso.primer.ai/api/v1/auth/login" \
  -H 'Content-Type: application/json' \
  -d '{"username": "$YOUR_USERNAME", "password": "$YOUR_PASSWORD"}'
```

## Glossary

| **Term**       | **Definition**                                                                                                                                                                                  |
| -------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Datasets**   | Data you upload is shared amongst your organization. Can be used in model preview or to get large scale predictions. It comprises training data as well as data to be analyzed by a model.      |
| **Documents**  | A dataset is made up of individual documents. These can be thought of as rows of data, or individual pieces of text to analyze.                                                                 |
| **Models**     | A list of the models in your account (templates you’ve liked and want to use). This is unique to you. Each model links to a page where you can get predictions or API credentials.              |
| **Prediction** | A prediction is what a model does with a piece of data you provide it. Each model may provide a different kind of result, but every unique judgment it makes is a prediction.                   |
| **Labels**     | Each prediction provides one or a number of labels. If a model can predict ten labels, for example our COVID classification model, your prediction will include ten results for the ten labels. |

# Datasets

Data you upload is shared amongst your organization. Can be used in model preview or to get large scale predictions. It comprises training data as well as data to be analyzed by a model.

## View all datasets

> Endpoint

```
GET /datasets/
```

_Gets all dataset objects_

> Response

```json
{
  "filters": [...],
  "datasets": [
    {
      "is_archived": false,
      "description": null,
      "creation_date": "2020-12-11T18:43:52.808062+00:00",
      "modified_date": "2020-12-11T18:43:52.808076+00:00",
      "num_documents": 100,
      "org_id": 1,
      "display_name": "covid_news_100.csv    ",
      "id": "58592a10-2eec-4424-a979-dae22bf94f5b",
      "document_type": "News",
      "user_id": "2976519311808060202",
      "models": [
        {
          "name": "Covid classifier",
          "id": "778f99eb-565d-4f96-88bd-4d820e5f63a6"
        },
        {
          "name": "CDC Analysis",
          "id": "e9ce751e-ad36-4c30-b44e-82ded4d84d7a"
        },
        {
          "name": "Healthcare news",
          "id": "2746047b-7a9f-486a-9b10-8c4c531fa7be"
        },
        {...}
      ]
    },
    {...},
  ]
}
```

## Create a new dataset entry

> Endpoint

```
PUT /datasets/
```

_Creates a new dataset meta entry_

> Parameters

```json
{
  "user_id": 4028440374033030052,
  "is_archived": false,
  "num_documents": 100,
  "org_id": 1,
  "display_name": "Bicycle_data",
  "document_type": "Social Media",
  "description": "Compiled bicycle dataset"
}
```

### Parameters

| Name          | In   | Type    | Required | Description                         |
| ------------- | ---- | ------- | -------- | ----------------------------------- |
| user_id       | body | integer | true     | User Id                             |
| is_archived   | body | boolean | true     | Indicates the status of the dataset |
| num_documents | body | integer | true     | Number of documents in the dataset  |
| org_id        | body | integer | true     | Organization Id                     |
| display_name  | body | string  | true     | Dataset name                        |
| document_type | body | string  | true     | Dataset document type               |
| description   | body | string  | false    | Dataset description                 |

> Response

```json
{
  "is_archived": false,
  "description": "Compiled bicycle dataset",
  "creation_date": "2021-08-04T03:36:52.020684+00:00",
  "modified_date": "2021-08-04T03:36:52.020701+00:00",
  "num_documents": 100,
  "org_id": 1,
  "display_name": "Bicycle_data",
  "id": "ed106536-1cd0-46c2-9447-d08bc501d373",
  "document_type": "Social Media",
  "user_id": "4028440374033030052",
  "models": []
}
```

### Response

| Status | Meaning                                                 | Description                         |
| ------ | ------------------------------------------------------- | ----------------------------------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | Request fulfilled, document follows |

## Upload a new dataset

> Endpoint

```
POST /datasets:upload
```

_Handles file uploads_

> Parameters

```shell
dataset_meta_display_name={$YOUR_DATASET_NAME}
dataset_meta_document_type=Other
filetype={$YOUR_FILE_TYPE}
```

> Example request (cURL)

```shell
curl --data-binary '@dev/sample.csv' /
"https://api.primer.ai/api/v1alpha/automate/datasets:upload?dataset_meta_display_name={$YOUR_DATASET_NAME}&dataset_meta_document_type=Other&filetype={$YOUR_FILE_TYPE}" /
-H "Authorization: JWT $YOUR_TOKEN"

```

> Example request (Python)

```python
import requests

data = open('./sample.csv', 'rb').read()
params = {
    'filetype': 'csv',
    'dataset_meta_document_type': 'Other',
    'dataset_meta_display_name': '$YOUR_DATASET_NAME'
}
headers = {
    "Authorization":
    "JWT $YOUR_TOKEN_HERE",
    "Content-Type": "application/binary",
}

r = requests.post('https://api.primer.ai/api/v1alpha/automate/datasets:upload',
                  params=params,
                  headers=headers,
                  data=data)
print(r.text)
```

### Parameters

| Name                       | In    | Type         | Required | Description                                     |
| -------------------------- | ----- | ------------ | -------- | ----------------------------------------------- |
| filetype                   | query | string       | true     | File type, valid options are: 'json' and 'csv'. |
| dataset_meta_document_type | query | string       | true     | Dataset document type.                          |
| dataset_meta_display_name  | query | string       | true     | Dataset display name.                           |
| header_matching_text       | query | string       | false    | Text header defined by user.                    |
| header_matching_title      | query | string       | false    | Title header defined by user.                   |
| header_matching_id         | query | string       | false    | Id header defined by user.                      |
| model_id                   | query | string(uuid) | false    | Model ID                                        |
| header_matching_label      | query | string       | false    | Label header defined by user.                   |
| dataset_meta_description   | query | string       | false    | Dataset description.                            |
| header_matching_date       | query | string       | false    | Date header defined by user.                    |

> Response

```json
{ "dataset_id": "3a437e2e-99fb-480c-a112-db9e82ae6ec7" }
```

### Response

| Status | Meaning                                                      | Description                   |
| ------ | ------------------------------------------------------------ | ----------------------------- |
| 201    | [Created](https://tools.ietf.org/html/rfc7231#section-6.3.2) | Document created, URL follows |

## Append data to existing dataset

> Endpoint

```
PATCH /datasets:upload
```

_Handles the addition of extra rows into an existing dataset_

Similar to post() method, but doesn't create a new dataset.

<h3 id="patch_dataset_upload_handler-parameters">Parameters</h3>

| Name                       | In    | Type         | Required | Description                                     |
| -------------------------- | ----- | ------------ | -------- | ----------------------------------------------- |
| header_matching_text       | query | string       | false    | Text header defined by user.                    |
| header_matching_title      | query | string       | false    | Title header defined by user.                   |
| filetype                   | query | string       | true     | File type, valid options are: 'json' and 'csv'. |
| dataset_meta_document_type | query | string       | false    | Dataset document type.                          |
| header_matching_id         | query | string       | false    | Id header defined by user.                      |
| model_id                   | query | string(uuid) | false    | Model ID                                        |
| header_matching_label      | query | string       | false    | Label header defined by user.                   |
| dataset_meta_description   | query | string       | false    | Dataset description.                            |
| dataset_meta_display_name  | query | string       | false    | Dataset display name.                           |
| dataset_id                 | query | string(uuid) | true     | Dataset id                                      |
| header_matching_date       | query | string       | false    | Date header defined by user.                    |

### Response

| Status | Meaning                                                 | Description |
| ------ | ------------------------------------------------------- | ----------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | Success     |

# Labels

## Download labels

> Endpoint

```
GET /labels:download
```

_Gets all labels applied to a dataset's documents_

Response is JSONL

### Parameters

| Name     | In    | Type         | Required | Description |
| -------- | ----- | ------------ | -------- | ----------- |
| model_id | query | string(uuid) | true     | Model Id    |

> Response

```json
{"document_id": "1008012", "document_title": null, "document_date": null, "document_text": "All we have to decide is what to do with the time that is given us.", "labels": [{"annotator_name": "Jonathan Bradshaw", "annotator_id": 4028440374030030052, "date_created": "2021-07-01T17:37:16.952341+00:00", "label_name": "NT", "value": false}, {"annotator_name": "Jonathan Bradshaw", "annotator_id": 4028440374030030052, "date_created": "2021-07-01T17:37:16.163235+00:00", "label_name": "OT", "value": true}]}
{"document_id": "1010019", "document_title": null, "document_date": null, "document_text": "It matters not what someone is born, but what they grow to be.", "labels": [{"annotator_name": "Jonathan Bradshaw", "annotator_id": 4028440374030030052, "date_created": "2021-07-01T17:32:27.362614+00:00", "label_name": "OT", "value": true}, {"annotator_name": "Jonathan Bradshaw", "annotator_id": 4028440374030030052, "date_created": "2021-07-01T17:32:28.722591+00:00", "label_name": "NT", "value": false}]}
```

### Response

| Status | Meaning                                                 | Description |
| ------ | ------------------------------------------------------- | ----------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | Success     |

# Models

## Deploy a model

> Endpoint

```
POST /models/{model_id}/deployment
```

_Deploys the latest version of a model_

### Parameters

| Name     | In   | Type   | Required | Description |
| -------- | ---- | ------ | -------- | ----------- |
| model_id | path | string | true     | none        |

> Response

```json
{
  "status_message": "Model deployment requested"
}
```

### Response

| Status | Meaning                                                      | Description                   | Schema                                                            |
| ------ | ------------------------------------------------------------ | ----------------------------- | ----------------------------------------------------------------- |
| 201    | [Created](https://tools.ietf.org/html/rfc7231#section-6.3.2) | Document created, URL follows | [ModelDeploymentCreateSchema](#schemamodeldeploymentcreateschema) |

## Request model prediction for a text

> Endpoint

```
POST /models/{model_id}/predictions
```

_Request predictions for a single text item passed as a parameter_

> Body parameter

```json
{
  "text": "It was the best of times, it was the blurst of times"
}
```

### Parameters

| Name     | In   | Type   | Required | Description         |
| -------- | ---- | ------ | -------- | ------------------- |
| text     | body | string | true     | Text for prediction |
| model_id | path | string | true     | none                |

> Response

```json
{
  "labels": [
    {
      "label": "NT",
      "score": 0.0020840661600232124,
      "threshold": 0.5,
      "classification": false
    },
    {
      "label": "OT",
      "score": 0.9969745874404907,
      "threshold": 0.5,
      "classification": true
    }
  ],
  "model_type": "CLF_MULTILABEL"
}
```

### Response

| Status | Meaning                                                 | Description                         |
| ------ | ------------------------------------------------------- | ----------------------------------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | Request fulfilled, document follows |

## Request bulk model predictions for text

> Endpoint

```
POST /models/predictions
```

_Creates a new request for bulk predictions_

> Body parameter

```json
{
  "dataset_id": "f99d8aff-98e0-4c16-bb0d-a1dd0153aeae",
  "model_id": "e9176b92-ad5f-46b8-8a6a-1363703db18e"
}
```

### Parameters

| Name       | In   | Type         | Required | Description |
| ---------- | ---- | ------------ | -------- | ----------- |
| model_id   | body | string(uuid) | true     | Model Id    |
| dataset_id | body | string(uuid) | true     | Dataset Id  |

> Response

```json
{
  "request_predictions_id": 16443
}
```

### Response

| Status | Meaning                                                      | Description                   |
| ------ | ------------------------------------------------------------ | ----------------------------- |
| 201    | [Created](https://tools.ietf.org/html/rfc7231#section-6.3.2) | Document created, URL follows |

## Get the status for a prediction job

> Endpoint

```
GET /models/predictions/{request_predictions_id}/status
```

_Get prediction job status_

### Parameters

| Name                   | In   | Type    | Required | Description |
| ---------------------- | ---- | ------- | -------- | ----------- |
| request_predictions_id | path | integer | true     | none        |

> Response

```json
{
  "status": "PROCESSING"
}
```

### Response

| Status | Meaning                                                 | Description                         |
| ------ | ------------------------------------------------------- | ----------------------------------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | Request fulfilled, document follows |

# Predictions

## Download all predictions for a model

> Endpoint

```
GET /predictions/
```

> Response

```json
{
  "model_type": "LIST",
  "labels": [{ "text": ["Swimming", "Sports", "Michael Phelps"] }]
}
```

_Gets all predictions from dataset_id for model model_id_

Generates a CSV or JSON file. The file is returned as the response payload and it should trigger a download prompt from the browser.

<aside class="notice">For NER models the return format must be specified as JSON. </aside>

This response's content is streamed, so there's no `Content-Length` header present
(we can't tell the final size from the start). This might trigger spurious warnings about
MIME types and document type mismatch in some browsers, but they should be safe to ignore.

### Parameters

| Name       | In    | Type         | Required | Description                      |
| ---------- | ----- | ------------ | -------- | -------------------------------- |
| dataset_id | query | string(uuid) | true     | Dataset Id                       |
| model_id   | query | string(uuid) | true     | Model Id                         |
| format     | query | string       | true     | Download request format e.g. CSV |

### Response

| Status | Meaning                                                 | Description |
| ------ | ------------------------------------------------------- | ----------- |
| 200    | [OK](https://tools.ietf.org/html/rfc7231#section-6.3.1) | Success     |
